(()=>{async function e(e){var n;e.preventDefault(),(n=e.currentTarget).textContent="ACTIVATING...",n.setAttribute("disabled",!0),await t()}async function t(){const e=document.getElementById("messager"),a=e.textContent,o=document.getElementById("meta-plugin-activate-btn");if(!document.getElementById("accept_tos").checked)return void async function(e,t,a,o,c){n(e,a,"err",o,"ACTIVATE"),setTimeout((()=>{e.textContent=t,e.classList.remove("err"),a.removeAttribute("disabled")}),5e3)}(e,a,o,metaAge.tosRequired);const c=document.querySelector("#registration_email");try{!async function(e,a,o,c,r){if(e.length>0){const s=e[0];try{const e=await ethereum.request({method:"eth_chainId"}),i=parseInt(e,16);!async function(e,a,o,c,r,s,i){networkInfo.testnets.includes(e)?async function(e,a,o){n(e,o,"err","Please switch to mainnet.","ACTIVATE");try{await ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x1"}]}),e.classList.remove("err"),e.textContent=a,o.textContent="ACTIVATE",t()}catch(e){console.log(e)}}(r,s,i):await async function(e,t,a,o,c){try{const r=await fetch(ajaxurl,{method:"POST",body:new URLSearchParams({email:e.value,address:t,plugin:"meta-age",ticker:a,action:"meta_age_activate_site"})}),s=await r.json();s.success?(n(o,c,"ok",s.message,"ACTIVATED"),setTimeout((()=>window.location.href=metaAge.adminURL),3e3)):n(o,c,"err",s.message,"ACTIVATE")}catch(e){console.log(e)}}(a,o,c,r,i)}(i,a,s,networkInfo.symbols[i]??"Unknown",o,c,r)}catch(e){n(o,r,"err","Error getting the current Ethereum chainId. Please switch to mainnet.","ACTIVATE"),console.log("Error getting the current Ethereum chainId.")}}else console.log("No Ethereum accounts found.")}(await ethereum.request({method:"eth_requestAccounts"}),c,e,a,o)}catch(e){console.log(`Error requesting Ethereum accounts: ${e}`)}}function n(e,t,n,a,o){e.classList.add(n),e.textContent=a,t.textContent=o,"ACTIVATE"===o&&t.removeAttribute("disabled")}window.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("meta-plugin-activate-btn");t&&(t.removeEventListener("click",e),t.addEventListener("click",e))}))})();